<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Actividades Alfa y Omega</title>
  <meta name="description" content="Registro de cultos y actividades religiosas semanales.">
  <meta name="theme-color" content="#6a994e">

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icon-192.png" sizes="192x192">

  <style>
    :root {
      --color-primary: #6a994e;
      --color-secondary: #a7c957;
      --color-accent: #f2e8cf;
      --color-bg: #fdfdfd;
      --color-card: #ffffff;
      --color-text: #333333;
      --color-border: #d0d0d0;
      --color-button: #d9edbf;
      --color-button-hover: #c2e0a8;
      --color-toggle-bg: #f0f5e5;
      --color-error: #f8d7da;
      --color-error-text: #721c24;
      --color-success: #d4edda;
      --color-success-text: #155724;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: var(--color-bg);
      color: var(--color-text);
      padding: 20px;
      line-height: 1.6;
    }

    h1 {
      text-align: center;
      margin-bottom: 24px;
      color: var(--color-primary);
      font-size: 1.8rem;
    }

    .day-section {
      background-color: var(--color-card);
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      border: 1px solid var(--color-border);
      overflow: hidden;
    }

    .day-header {
      padding: 16px 20px;
      background-color: var(--color-toggle-bg);
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      color: var(--color-primary);
    }

    .day-header:hover {
      background-color: #e8f0d5;
    }

    .day-content {
      padding: 0;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, padding 0.3s ease;
    }

    .day-content.open {
      padding: 20px;
      max-height: 1000px;
    }

    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      color: var(--color-text);
    }

    input[type="text"],
    input[type="date"],
    select,
    textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      background-color: #fafafa;
      font-size: 1rem;
    }

    .btn {
      background-color: var(--color-button);
      color: var(--color-text);
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.2s;
      display: inline-block;
      margin-top: 10px;
    }

    .btn:hover {
      background-color: var(--color-button-hover);
    }

    .btn-full {
      width: 100%;
      margin-top: 16px;
    }

    .message {
      padding: 12px;
      border-radius: 8px;
      margin: 12px 0;
      font-weight: 500;
      display: none;
    }

    .message.error {
      background-color: var(--color-error);
      color: var(--color-error-text);
      display: block;
    }

    .message.success {
      background-color: var(--color-success);
      color: var(--color-success-text);
      display: block;
    }

    .search-section {
      background-color: var(--color-card);
      border-radius: 12px;
      padding: 20px;
      margin-top: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      border: 1px solid var(--color-border);
      display: none;
    }

    .search-section h2 {
      margin-bottom: 16px;
      color: var(--color-secondary);
    }

    .record-display {
      margin-top: 16px;
      padding: 12px;
      background-color: #f9f9f9;
      border-radius: 8px;
      white-space: pre-wrap;
      font-family: monospace;
      font-size: 0.95rem;
      position: relative;
    }

    .close-btn {
      background-color: #ffcccc;
      color: #b00000;
      border: none;
      border-radius: 6px;
      padding: 6px 10px;
      font-size: 0.9rem;
      cursor: pointer;
      margin-top: 10px;
    }

    .close-btn:hover {
      background-color: #ffb3b3;
    }
  </style>
</head>
<body>
  <h1>Actividades Alfa y Omega</h1>

  <!-- Martes -->
  <section class="day-section">
    <div class="day-header" data-day="martes">
      <span>Martes - Culto de Oración</span>
      <span>▶</span>
    </div>
    <div class="day-content" id="content-martes">
      <div class="form-group">
        <label for="martes-fecha">Fecha</label>
        <input type="date" id="martes-fecha" />
      </div>
      <div class="form-group">
        <label for="martes-director">Director</label>
        <input type="text" id="martes-director" placeholder="Nombre del director" />
      </div>
      <div class="form-group">
        <label for="martes-cita">Cita Bíblica</label>
        <input type="text" id="martes-cita" placeholder="Ej. Salmo 23:1" />
      </div>
      <button class="btn btn-full generate-btn" data-day="martes">Generar Registro</button>
      <div class="message" id="msg-martes"></div>
    </div>
  </section>

  <!-- Jueves -->
  <section class="day-section">
    <div class="day-header" data-day="jueves">
      <span>Jueves - Culto de Enseñanza</span>
      <span>▶</span>
    </div>
    <div class="day-content" id="content-jueves">
      <div class="form-group">
        <label for="jueves-fecha">Fecha</label>
        <input type="date" id="jueves-fecha" />
      </div>
      <div class="form-group">
        <label for="jueves-tipo">Tipo de Enseñanza</label>
        <select id="jueves-tipo">
          <option value="">Seleccionar...</option>
          <option value="damas">Damas</option>
          <option value="videos">Videos</option>
          <option value="comision">Comisión</option>
          <option value="otros">Otros</option>
        </select>
      </div>
      <div class="form-group">
        <label for="jueves-director">Director</label>
        <input type="text" id="jueves-director" placeholder="Nombre del director" />
      </div>
      <div class="form-group">
        <label for="jueves-cita-dir">Cita Bíblica (Director)</label>
        <input type="text" id="jueves-cita-dir" placeholder="Ej. Proverbios 3:5-6" />
      </div>
      <div class="form-group">
        <label for="jueves-predicador">Predicador</label>
        <input type="text" id="jueves-predicador" placeholder="Nombre del predicador" />
      </div>
      <div class="form-group">
        <label for="jueves-cita-pred">Cita Bíblica (Predicación)</label>
        <input type="text" id="jueves-cita-pred" placeholder="Ej. Juan 14:6" />
      </div>
      <div class="form-group">
        <label for="jueves-tema">Nombre del Tema</label>
        <input type="text" id="jueves-tema" placeholder="Tema de la enseñanza" />
      </div>
      <button class="btn btn-full generate-btn" data-day="jueves">Generar Registro</button>
      <div class="message" id="msg-jueves"></div>
    </div>
  </section>

  <!-- Viernes (Vigilia) -->
  <section class="day-section">
    <div class="day-header" data-day="viernes">
      <span>Viernes - Vigilia</span>
      <span>▶</span>
    </div>
    <div class="day-content" id="content-viernes">
      <div class="form-group">
        <label for="viernes-fecha">Fecha</label>
        <input type="date" id="viernes-fecha" />
      </div>
      <div class="form-group">
        <label for="viernes-director">Director</label>
        <input type="text" id="viernes-director" placeholder="Nombre del director" />
      </div>
      <div class="form-group">
        <label for="viernes-cita-dir">Cita Bíblica</label>
        <input type="text" id="viernes-cita-dir" placeholder="Ej. Isaías 58:6" />
      </div>
      <div class="form-group">
        <label for="viernes-predicador">Predicador o Predicadora</label>
        <input type="text" id="viernes-predicador" placeholder="Nombre del predicador o predicadora" />
      </div>
      <div class="form-group">
        <label for="viernes-cita-pred">Cita Bíblica (Predicación)</label>
        <input type="text" id="viernes-cita-pred" placeholder="Ej. Mateo 6:33" />
      </div>
      <div class="form-group">
        <label for="viernes-tema">Nombre del Tema</label>
        <input type="text" id="viernes-tema" placeholder="Tema de la predicación" />
      </div>
      <button class="btn btn-full generate-btn" data-day="viernes">Generar Registro</button>
      <div class="message" id="msg-viernes"></div>
    </div>
  </section>

  <!-- Sábado -->
  <section class="day-section">
    <div class="day-header" data-day="sabado">
      <span>Sábado - Actividad Especial</span>
      <span>▶</span>
    </div>
    <div class="day-content" id="content-sabado">
      <div class="form-group">
        <label for="sabado-fecha">Fecha</label>
        <input type="date" id="sabado-fecha" />
      </div>
      <div class="form-group">
        <label for="sabado-tipo">Tipo de Actividad</label>
        <select id="sabado-tipo">
          <option value="">Seleccionar...</option>
          <option value="ayuno">Ayuno</option>
          <option value="culto">Culto</option>
          <option value="confraternidad">Confraternidad</option>
          <option value="otros">Otros</option>
        </select>
      </div>
      <div class="form-group">
        <label for="sabado-director">Director</label>
        <input type="text" id="sabado-director" placeholder="Nombre del director" />
      </div>
      <div class="form-group">
        <label for="sabado-cita-dir">Cita Bíblica (Director)</label>
        <input type="text" id="sabado-cita-dir" placeholder="Ej. Isaías 58:6" />
      </div>
      <div class="form-group">
        <label for="sabado-predicador">Predicador o Predicadora</label>
        <input type="text" id="sabado-predicador" placeholder="Nombre del predicador o predicadora" />
      </div>
      <div class="form-group">
        <label for="sabado-cita-pred">Cita Bíblica (Predicación)</label>
        <input type="text" id="sabado-cita-pred" placeholder="Ej. Mateo 6:33" />
      </div>
      <div class="form-group">
        <label for="sabado-tema">Nombre del Tema</label>
        <input type="text" id="sabado-tema" placeholder="Tema de la predicación" />
      </div>
      <button class="btn btn-full generate-btn" data-day="sabado">Generar Registro</button>
      <div class="message" id="msg-sabado"></div>
    </div>
  </section>

  <!-- Domingo -->
  <section class="day-section">
    <div class="day-header" data-day="domingo">
      <span>Domingo - Escuela Dominical</span>
      <span>▶</span>
    </div>
    <div class="day-content" id="content-domingo">
      <div class="form-group">
        <label for="domingo-fecha">Fecha</label>
        <input type="date" id="domingo-fecha" />
      </div>
      <div class="form-group">
        <label for="domingo-director">Director</label>
        <input type="text" id="domingo-director" placeholder="Nombre del director" />
      </div>
      <div class="form-group">
        <label for="domingo-cita-dir">Cita Bíblica (Director)</label>
        <input type="text" id="domingo-cita-dir" placeholder="Ej. Hechos 2:42" />
      </div>
      <div class="form-group">
        <label for="domingo-predicador">Predicador o Predicadora</label>
        <input type="text" id="domingo-predicador" placeholder="Nombre del predicador o predicadora" />
      </div>
      <div class="form-group">
        <label for="domingo-cita-pred">Cita Bíblica (Predicación)</label>
        <input type="text" id="domingo-cita-pred" placeholder="Ej. Romanos 8:28" />
      </div>
      <div class="form-group">
        <label for="domingo-tema">Nombre del Tema</label>
        <input type="text" id="domingo-tema" placeholder="Tema de la enseñanza" />
      </div>
      <button class="btn btn-full generate-btn" data-day="domingo">Generar Registro</button>
      <div class="message" id="msg-domingo"></div>
    </div>
  </section>

  <div style="text-align: center; margin-top: 20px;">
    <button class="btn" id="btn-buscar">Buscar Registros</button>
  </div>

  <div class="search-section" id="search-section">
    <h2>Buscar Registro por Fecha</h2>
    <div class="form-group">
      <label for="search-fecha">Selecciona una fecha</label>
      <input type="date" id="search-fecha" />
    </div>
    <button class="btn" id="btn-buscar-submit">Buscar</button>
    <div class="record-display" id="record-result"></div>
    <button class="close-btn" id="btn-cerrar-resultado">Cerrar</button>
  </div>

  <script>
    // Registrar Service Worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(reg => console.log('SW registrado:', reg.scope))
          .catch(err => console.warn('Error al registrar SW:', err));
      });
    }

    // === Toggle, guardar, buscar... (mismo código funcional que antes) ===
    document.querySelectorAll('.day-header').forEach(header => {
      header.addEventListener('click', () => {
        const day = header.getAttribute('data-day');
        const content = document.getElementById(`content-${day}`);
        const isOpen = content.classList.contains('open');
        document.querySelectorAll('.day-content').forEach(c => {
          c.classList.remove('open');
          c.previousElementSibling.querySelector('span:last-child').textContent = '▶';
        });
        if (!isOpen) {
          content.classList.add('open');
          header.querySelector('span:last-child').textContent = '▼';
        }
      });
    });

    function resetForm(day) {
      document.querySelectorAll(`#content-${day} input[type="text"], #content-${day} input[type="date"]`).forEach(el => el.value = '');
      document.querySelectorAll(`#content-${day} select`).forEach(el => el.selectedIndex = 0);
    }

    document.querySelectorAll('.generate-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const day = btn.getAttribute('data-day');
        const msgEl = document.getElementById(`msg-${day}`);
        msgEl.className = 'message';

        const fecha = document.getElementById(`${day}-fecha`)?.value;
        if (!fecha) {
          msgEl.textContent = '⚠️ Por favor, selecciona una fecha.';
          msgEl.classList.add('error');
          return;
        }

        let isValid = false;
        let data = { fecha };

        switch (day) {
          case 'martes':
            data.tipo = 'Martes - Culto de Oración';
            data.director = document.getElementById('martes-director').value.trim();
            data.cita = document.getElementById('martes-cita').value.trim();
            isValid = !!data.director;
            break;
          case 'jueves':
            data.tipo = 'Jueves - Culto de Enseñanza';
            data.subtipo = document.getElementById('jueves-tipo').value;
            data.director = document.getElementById('jueves-director').value.trim();
            data.predicador = document.getElementById('jueves-predicador').value.trim();
            isValid = !!data.director && !!data.subtipo;
            break;
          case 'viernes':
            data.tipo = 'Viernes - Vigilia';
            data.director = document.getElementById('viernes-director').value.trim();
            data.predicador = document.getElementById('viernes-predicador').value.trim();
            isValid = !!data.director;
            break;
          case 'sabado':
            data.tipo = 'Sábado - Actividad Especial';
            data.subtipo = document.getElementById('sabado-tipo').value;
            data.director = document.getElementById('sabado-director').value.trim();
            isValid = !!data.director && !!data.subtipo;
            break;
          case 'domingo':
            data.tipo = 'Domingo - Escuela Dominical';
            data.director = document.getElementById('domingo-director').value.trim();
            data.predicador = document.getElementById('domingo-predicador').value.trim();
            isValid = !!data.director;
            break;
        }

        if (!isValid) {
          msgEl.textContent = '⚠️ Completa los campos obligatorios (al menos Director y Fecha).';
          msgEl.classList.add('error');
          return;
        }

        localStorage.setItem(`registro-${fecha}-${day}`, JSON.stringify(data));
        resetForm(day);
        msgEl.textContent = '✅ Registro guardado con éxito.';
        msgEl.classList.add('success');
      });
    });

    document.getElementById('btn-buscar').addEventListener('click', () => {
      const sec = document.getElementById('search-section');
      sec.style.display = sec.style.display === 'block' ? 'none' : 'block';
    });

    document.getElementById('btn-cerrar-resultado').addEventListener('click', () => {
      document.getElementById('record-result').textContent = '';
      document.getElementById('search-section').style.display = 'none';
    });

    document.getElementById('btn-buscar-submit').addEventListener('click', () => {
      const fecha = document.getElementById('search-fecha').value;
      if (!fecha) {
        document.getElementById('record-result').textContent = '❌ Selecciona una fecha.';
        return;
      }

      let result = '';
      ['martes','jueves','viernes','sabado','domingo'].forEach(dia => {
        const item = localStorage.getItem(`registro-${fecha}-${dia}`);
        if (item) {
          const d = JSON.parse(item);
          result += `📅 ${d.tipo}\n🗓 ${d.fecha}\n`;
          if (d.subtipo) result += `🏷 ${d.subtipo}\n`;
          if (d.director) result += `👤 Director: ${d.director}\n`;
          if (d.predicador) result += `🗣 Predicador/a: ${d.predicador}\n`;
          if (d.cita) result += `📖 Cita: ${d.cita}\n`;
          if (d.tema) result += `🎯 Tema: ${d.tema}\n`;
          result += '\n';
        }
      });

      const resDiv = document.getElementById('record-result');
      resDiv.textContent = result ? result.trim() : '❌ No se encontró ningún registro para esta fecha.';
    });
  </script>
</body>
</html>